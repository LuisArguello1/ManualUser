================================================================================
    SISTEMA DE GESTIÃ“N VETERINARIA - MANUAL DE USUARIO
    PARTE 2: MASCOTAS, IA, BIOMETRÃA Y FUNCIONALIDADES
================================================================================

FECHA: Noviembre 2025
VERSIÃ“N: 1.0
PROPÃ“SITO: DocumentaciÃ³n tÃ©cnica completa para desarrollo de manual de usuario


================================================================================
1. REGISTRO DE MASCOTAS
================================================================================

1.1 LÃMITE DE MASCOTAS POR USUARIO
----------------------------------
RESTRICCIÃ“N IMPORTANTE: Cada usuario tipo OWNER puede registrar MÃXIMO 2 MASCOTAS

VerificaciÃ³n del sistema:
- Antes de mostrar formulario de registro
- Al intentar guardar una nueva mascota
- Mensaje: "Has alcanzado el lÃ­mite mÃ¡ximo de 2 mascotas por usuario. No puedes registrar mÃ¡s mascotas."

EXCEPCIÃ“N: Administradores (ADMIN) pueden tener mÃ¡s de 2


1.2 ACCESO AL FORMULARIO DE REGISTRO
------------------------------------
URL: /mascota/register/

RUTAS DE ACCESO:
1. Dashboard â†’ BotÃ³n "Registrar Nueva Mascota"
2. MenÃº lateral â†’ "Registrar Mascota"
3. Lista de mascotas â†’ BotÃ³n "Agregar Mascota" (si tiene menos de 2)

VALIDACIÃ“N PREVIA:
Si el usuario ya tiene 2 mascotas:
- Se muestra mensaje de lÃ­mite alcanzado
- BotÃ³n de registro deshabilitado
- Opciones: Editar mascota existente o Eliminar una para agregar nueva


1.3 FORMULARIO DE REGISTRO - CAMPOS
-----------------------------------

INFORMACIÃ“N BÃSICA (OBLIGATORIO):
1. Nombre de la mascota
   - Tipo: Texto
   - MÃ¡ximo: 120 caracteres
   - ValidaciÃ³n: Solo letras y espacios

2. Foto de perfil
   - Tipo: Imagen
   - Formatos: JPG, JPEG, PNG, WEBP
   - TamaÃ±o mÃ¡ximo: 5 MB
   - IMPORTANTE: Esta foto se usa para predicciÃ³n de IA
   - RecomendaciÃ³n: Foto clara, de frente, buena iluminaciÃ³n

INFORMACIÃ“N AUTOMÃTICA (PREDICCIÃ“N CON IA):
3. Raza
   - Se predice automÃ¡ticamente al subir foto
   - Opciones detectables por IA:
     * Bulldog
     * Chihuahua
     * Golden Retriever
   - Si no es una de estas razas â†’ "Otra raza"
   - Usuario puede editar manualmente despuÃ©s

4. Etapa de vida
   - Se predice automÃ¡ticamente
   - Opciones:
     * Cachorro (0-1 aÃ±o)
     * Joven (1-3 aÃ±os)
     * Adulto (3-7 aÃ±os)
     * Senior (7+ aÃ±os)
   - Usuario puede editar manualmente

5. CondiciÃ³n corporal
   - Se predice automÃ¡ticamente
   - Opciones:
     * Delgado (bajo peso)
     * Normal/Ideal (peso saludable)
     * Sobrepeso/Obeso (exceso de peso)
   - Usuario puede editar manualmente

INFORMACIÃ“N ADICIONAL:
6. Sexo
   - Macho / Hembra

7. Edad
   - NÃºmero + Unidad (aÃ±os o meses)
   - Ejemplo: 3 aÃ±os, 8 meses

8. Fecha de nacimiento
   - Selector de fecha
   - Alternativa a ingresar edad directa

9. Peso
   - NÃºmero decimal (kg)
   - Ejemplo: 15.5 kg
   - MÃ¡ximo 200 kg

10. Color
    - Texto libre
    - Ejemplo: "CafÃ© con manchas blancas"

11. CaracterÃ­sticas especiales
    - Textarea
    - Marcas distintivas, comportamiento, alergias, etc.
    - Ejemplo: "Cicatriz en oreja derecha, alÃ©rgico al pollo"


1.4 PROCESO DE PREDICCIÃ“N CON IA (AUTOMÃTICO)
---------------------------------------------

FLUJO COMPLETO:

1. USUARIO SUBE FOTO DE PERFIL:
   - Selecciona archivo desde su dispositivo
   - Vista previa se muestra inmediatamente
   - BotÃ³n "Predecir con IA" se habilita

2. USUARIO PRESIONA "PREDECIR CON IA":
   - Se muestra loading spinner
   - Mensaje: "Analizando imagen..."
   - La foto se envÃ­a al servidor

3. PROCESAMIENTO EN EL SERVIDOR:

   A) DETECCIÃ“N DE PERRO:
      - Modelo: Haar Cascade Classifier (dog-cascade_40x40_rev2.xml)
      - Busca rostro de perro en la imagen
      - Si NO detecta perro:
        * Error: "No se detectÃ³ un perro en la imagen"
        * PredicciÃ³n se cancela
      - Si detecta perro:
        * Recorta Ã¡rea del rostro
        * ContinÃºa con predicciÃ³n

   B) PREDICCIÃ“N DE RAZA Y ETAPA:
      - Modelo: ResNet-18 Multi-Tarea
      - Entrada: Imagen 224x224 pÃ­xeles
      - Procesamiento:
        * ExtracciÃ³n de 512 caracterÃ­sticas
        * AnÃ¡lisis de:
          - Forma y posiciÃ³n de orejas
          - Estructura del hocico
          - TamaÃ±o y forma de ojos
          - Textura del pelaje
          - Proporciones corporales
          - Patrones de color
      
      - Salida RAZA:
        * PuntuaciÃ³n para cada raza (0-100%)
        * Ejemplo:
          - Bulldog: 0.53%
          - Chihuahua: 0.03%
          - Golden Retriever: 99.44% â† PREDICCIÃ“N
        * Umbral: Si confianza â‰¥ 98% â†’ Acepta
        * Si < 98% â†’ "Otra raza"
      
      - Salida ETAPA DE VIDA:
        * PuntuaciÃ³n para cada etapa
        * Ejemplo:
          - Cachorro: 1.23%
          - Joven: 4.56%
          - Adulto: 92.34% â† PREDICCIÃ“N
          - Senior: 1.87%
        * Se selecciona la de mayor puntuaciÃ³n

   C) PREDICCIÃ“N DE CONDICIÃ“N CORPORAL:
      - Modelo: ResNet-50
      - Entrada: Imagen 224x224 pÃ­xeles
      - Procesamiento:
        * ExtracciÃ³n de 2,048 caracterÃ­sticas
        * AnÃ¡lisis de:
          - Visibilidad de costillas
          - DefiniciÃ³n de cintura (vista superior)
          - ElevaciÃ³n abdominal (vista lateral)
          - DistribuciÃ³n de grasa corporal
          - RelaciÃ³n mÃºsculo/grasa
      
      - Salida:
        * Ejemplo:
          - Delgado: 1.34%
          - Normal: 95.23% â† PREDICCIÃ“N
          - Obeso: 3.43%
        * Se selecciona la de mayor puntuaciÃ³n

4. RESULTADOS MOSTRADOS AL USUARIO:

   Panel de predicciones con:
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  ğŸ“Š PREDICCIONES DE INTELIGENCIA ARTIFICIAL â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  ğŸ• RAZA DETECTADA                          â”‚
   â”‚  âœ… Golden Retriever (99.44% confianza)     â”‚
   â”‚  Alta confianza                             â”‚
   â”‚                                             â”‚
   â”‚  ğŸ“… ETAPA DE VIDA                           â”‚
   â”‚  âœ… Adulto (92.34% confianza)               â”‚
   â”‚  Alta confianza                             â”‚
   â”‚                                             â”‚
   â”‚  âš–ï¸ CONDICIÃ“N CORPORAL                      â”‚
   â”‚  âœ… Normal/Ideal (95.23% confianza)         â”‚
   â”‚  Alta confianza                             â”‚
   â”‚                                             â”‚
   â”‚  [Ver todas las probabilidades â–¼]          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1.5 NIVEL DE CONFIANZA DE LAS PREDICCIONES
------------------------------------------

INTERPRETACIÃ“N:

ALTA (> 80%):
- Color: Verde
- Icono: âœ…
- Significado: El modelo estÃ¡ muy seguro de la predicciÃ³n
- AcciÃ³n recomendada: Aceptar predicciÃ³n

MEDIA (60% - 80%):
- Color: Amarillo
- Icono: âš ï¸
- Significado: El modelo tiene dudas, podrÃ­a ser otra opciÃ³n
- AcciÃ³n recomendada: Revisar y considerar editar

BAJA (< 60%):
- Color: Rojo
- Icono: âŒ
- Significado: El modelo no estÃ¡ seguro, predicciÃ³n poco confiable
- AcciÃ³n recomendada: Editar manualmente


1.6 EXPANSIÃ“N DE DETALLES (VER TODAS LAS PROBABILIDADES)
--------------------------------------------------------

Al hacer clic en "Ver todas las probabilidades", se expande:

RAZA:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¥‡ Golden Retriever: 99.44%    â”‚
â”‚ ğŸ¥ˆ Bulldog: 0.53%              â”‚
â”‚ ğŸ¥‰ Chihuahua: 0.03%            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ETAPA DE VIDA:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¥‡ Adulto: 92.34%              â”‚
â”‚ ğŸ¥ˆ Joven: 4.56%                â”‚
â”‚ ğŸ¥‰ Cachorro: 1.23%             â”‚
â”‚    Senior: 1.87%               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONDICIÃ“N CORPORAL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¥‡ Normal: 95.23%              â”‚
â”‚ ğŸ¥ˆ Obeso: 3.43%                â”‚
â”‚ ğŸ¥‰ Delgado: 1.34%              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


1.7 MENSAJES DE ERROR EN PREDICCIÃ“N
-----------------------------------

ERROR 1: No se detectÃ³ perro
Causa: La imagen no contiene un perro visible
SoluciÃ³n: Subir foto diferente con el perro visible

ERROR 2: Imagen muy pequeÃ±a
Causa: ResoluciÃ³n < 50x50 pÃ­xeles
SoluciÃ³n: Usar imagen de mayor resoluciÃ³n

ERROR 3: Archivo muy grande
Causa: TamaÃ±o > 5 MB
SoluciÃ³n: Comprimir imagen o usar otra

ERROR 4: Formato no vÃ¡lido
Causa: Archivo no es JPG/PNG/WEBP
SoluciÃ³n: Convertir imagen a formato compatible

ERROR 5: Confianza baja en raza
Resultado: Se marca como "Otra raza"
ExplicaciÃ³n: El perro no es Bulldog, Chihuahua ni Golden Retriever
Usuario puede escribir la raza manualmente


1.8 GUARDAR REGISTRO DE MASCOTA
-------------------------------

PROCESO:

1. Usuario completa/revisa todos los campos
2. Presiona botÃ³n "Registrar Mascota"
3. Validaciones finales:
   âœ“ Nombre no vacÃ­o
   âœ“ Foto de perfil obligatoria
   âœ“ Usuario no exceda 2 mascotas
4. Se crea registro en base de datos
5. Se genera UUID Ãºnico para la mascota (para QR)
6. Campos automÃ¡ticos:
   - created_at: Fecha y hora actual
   - propietario: Usuario actual
   - biometria_entrenada: False (inicialmente)
   - reportar_perdida: False

RESULTADO EXITOSO:
- NotificaciÃ³n: "Mascota registrada exitosamente"
- RedirecciÃ³n a: Lista de mascotas o Detalle de mascota
- OpciÃ³n destacada: "Agregar Registro BiomÃ©trico" (recomendado)


1.9 RECOMENDACIONES PARA MEJOR PREDICCIÃ“N
-----------------------------------------

FOTO IDEAL PARA IA:
âœ“ Perro de frente o semi-perfil
âœ“ Rostro completo visible
âœ“ Buena iluminaciÃ³n natural
âœ“ Fondo simple (sin distracciones)
âœ“ Perro solo (sin otras mascotas/personas)
âœ“ ResoluciÃ³n mÃ­nima 224x224 pÃ­xeles
âœ“ Formato JPG o PNG
âœ“ Perro quieto (no borroso)

EVITAR:
âœ— Fotos muy oscuras o a contraluz
âœ— Perro de espalda
âœ— MÃºltiples perros en la imagen
âœ— Rostro parcialmente oculto
âœ— ImÃ¡genes borrosas o movidas
âœ— Filtros o efectos aplicados


================================================================================
2. LISTA DE MASCOTAS
================================================================================

URL: /mascota/list/

2.1 VISUALIZACIÃ“N
-----------------

PARA USUARIOS TIPO OWNER:
- Solo ve SUS 2 mascotas (o menos)
- Vista de tarjetas (cards)

PARA USUARIOS TIPO VET:
- Ve TODAS las mascotas del sistema
- Puede filtrar y buscar

PARA ADMIN:
- Ve TODAS las mascotas del sistema
- Acceso completo a gestiÃ³n

ELEMENTOS DE CADA TARJETA:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Foto de perfil]                  â”‚
â”‚                                    â”‚
â”‚  ğŸ• Nombre de la mascota           â”‚
â”‚  ğŸ“Š Raza | Edad | Sexo             â”‚
â”‚  âš–ï¸ CondiciÃ³n corporal             â”‚
â”‚  ğŸ·ï¸ Etapa de vida                  â”‚
â”‚                                    â”‚
â”‚  Estado biomÃ©trico:                â”‚
â”‚  âœ… Activa / âŒ No registrada      â”‚
â”‚                                    â”‚
â”‚  Estado:                           â”‚
â”‚  ğŸ†— Normal / ğŸš¨ Perdida            â”‚
â”‚                                    â”‚
â”‚  [Ver Detalle] [Editar] [Eliminar]â”‚
â”‚  [QR Code] [Carnet]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2.2 INDICADORES VISUALES
------------------------

BIOMETRÃA ACTIVA:
- Badge verde: "BiometrÃ­a Activa"
- Icono: âœ…
- Tooltip: "Esta mascota puede ser reconocida por el escÃ¡ner"

BIOMETRÃA NO REGISTRADA:
- Badge gris: "Sin BiometrÃ­a"
- Icono: âŒ
- Tooltip: "Agrega imÃ¡genes biomÃ©tricas para habilitar reconocimiento"

MASCOTA PERDIDA:
- Badge rojo parpadeante: "ğŸš¨ PERDIDA"
- Borde rojo en toda la tarjeta
- BotÃ³n destacado: "Reportar como encontrada"

MASCOTA NORMAL:
- Sin badges de alerta
- Borde normal


2.3 ACCIONES DISPONIBLES
------------------------

BOTÃ“N "VER DETALLE":
- RedirecciÃ³n a pÃ¡gina de detalle completo
- Muestra toda la informaciÃ³n de la mascota

BOTÃ“N "EDITAR":
- Solo disponible para propietario
- RedirecciÃ³n a formulario de ediciÃ³n

BOTÃ“N "ELIMINAR":
- Solo disponible para propietario
- ConfirmaciÃ³n requerida (modal)
- Advertencia: "Â¿EstÃ¡s seguro? Esta acciÃ³n no se puede deshacer"

BOTÃ“N "CÃ“DIGO QR":
- Genera QR con informaciÃ³n pÃºblica
- Se puede compartir o imprimir


================================================================================
3. DETALLE DE MASCOTA
================================================================================

URL: /mascota/detalle/<id>/

3.1 INFORMACIÃ“N MOSTRADA
------------------------

SECCIÃ“N 1: DATOS BÃSICOS
- Foto de perfil (grande)
- Nombre
- Raza
- Edad completa (aÃ±os y meses)
- Fecha de nacimiento
- Sexo
- Peso actual
- Color
- Etapa de vida
- CondiciÃ³n corporal
- CaracterÃ­sticas especiales

SECCIÃ“N 2: INFORMACIÃ“N DEL PROPIETARIO
- Nombre completo del dueÃ±o
- Email de contacto
- TelÃ©fono (si disponible)

SECCIÃ“N 3: ESTADO BIOMÃ‰TRICO
- Cantidad de imÃ¡genes biomÃ©tricas registradas
- Estado: Activa (â‰¥5 imÃ¡genes) / Inactiva (<5 imÃ¡genes)
- Confianza promedio del reconocimiento (si disponible)
- Fecha de Ãºltimo entrenamiento

SECCIÃ“N 4: HISTORIAL
- Fecha de registro
- Ãšltima actualizaciÃ³n
- Cantidad de veces reconocida en escÃ¡ner

SECCIÃ“N 5: ESTADO ACTUAL
- Normal / Reportada como perdida
- Si estÃ¡ perdida:
  * Fecha de reporte
  * UbicaciÃ³n donde se perdiÃ³ (si se proporcionÃ³)


3.2 ACCIONES DISPONIBLES (SOLO PROPIETARIO)
-------------------------------------------

BOTÃ“N "EDITAR INFORMACIÃ“N":
- RedirecciÃ³n a formulario de ediciÃ³n
- Todos los campos son editables

BOTÃ“N "AGREGAR/GESTIONAR BIOMETRÃA":
- Si tiene <5 imÃ¡genes: "Agregar Registro BiomÃ©trico"
- Si tiene â‰¥5 imÃ¡genes: "Gestionar BiometrÃ­a"
- RedirecciÃ³n a mÃ³dulo de biometrÃ­a

BOTÃ“N "GENERAR CÃ“DIGO QR":
- Genera QR instantÃ¡neo
- Opciones:
  * Ver en pantalla
  * Descargar imagen PNG
  * Copiar enlace pÃºblico

BOTÃ“N "GENERAR CARNET":
- Crea carnet digital con foto y datos
- Opciones:
  * Vista previa
  * Descargar PDF
  * Imprimir

BOTÃ“N "REPORTAR COMO PERDIDA":
- Modal de confirmaciÃ³n
- Solicita ubicaciÃ³n opcional
- Al confirmar:
  * Marca mascota como perdida
  * EnvÃ­a email masivo a TODOS los usuarios
  * Crea notificaciÃ³n in-app
  * Muestra en dashboard de mascotas perdidas

BOTÃ“N "REPORTAR COMO ENCONTRADA":
- Solo visible si mascota estÃ¡ perdida
- Modal de confirmaciÃ³n
- Al confirmar:
  * Desmarca flag de perdida
  * EnvÃ­a notificaciÃ³n al propietario
  * Remueve de lista de perdidas

BOTÃ“N "ELIMINAR MASCOTA":
- BotÃ³n rojo, en zona de peligro
- ConfirmaciÃ³n con texto de verificaciÃ³n
- Advertencias:
  * "Esta acciÃ³n es permanente"
  * "Se eliminarÃ¡n todas las imÃ¡genes biomÃ©tricas"
  * "Se eliminarÃ¡ el QR asociado"
  * "Los carnets generados ya no funcionarÃ¡n"
- Requiere escribir nombre de la mascota para confirmar


3.3 RECOMENDACIONES PERSONALIZADAS
----------------------------------

El sistema genera recomendaciones automÃ¡ticas basadas en:
- Etapa de vida
- CondiciÃ³n corporal
- Raza (si estÃ¡ registrada)

CATEGORÃAS:
1. ğŸ– ALIMENTACIÃ“N
2. ğŸƒ EJERCICIO
3. âš•ï¸ SALUD
4. ğŸ› CUIDADO GENERAL

EJEMPLO PARA CACHORRO + NORMAL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ– ALIMENTACIÃ“N                             â”‚
â”‚ â€¢ Alimento especÃ­fico para cachorros       â”‚
â”‚ â€¢ 3-4 comidas pequeÃ±as al dÃ­a              â”‚
â”‚ â€¢ Asegurar hidrataciÃ³n constante           â”‚
â”‚                                             â”‚
â”‚ ğŸƒ EJERCICIO                                â”‚
â”‚ â€¢ Juegos cortos y supervisados             â”‚
â”‚ â€¢ Evitar ejercicio intenso                 â”‚
â”‚                                             â”‚
â”‚ âš•ï¸ SALUD                                    â”‚
â”‚ â€¢ Calendario de vacunaciÃ³n completo        â”‚
â”‚ â€¢ DesparasitaciÃ³n cada 2-4 semanas         â”‚
â”‚ â€¢ Visitas veterinarias mensuales           â”‚
â”‚                                             â”‚
â”‚ ğŸ› CUIDADO GENERAL                          â”‚
â”‚ â€¢ SocializaciÃ³n temprana                   â”‚
â”‚ â€¢ Entrenamiento bÃ¡sico                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
4. EDITAR MASCOTA
================================================================================

URL: /mascota/editar/<id>/
Solo accesible por propietario

4.1 CAMPOS EDITABLES
-------------------

TODOS los campos son editables:
- Foto de perfil (cambiar imagen)
- Nombre
- Raza
- Etapa de vida
- CondiciÃ³n corporal
- Sexo
- Edad
- Fecha de nacimiento
- Peso
- Color
- CaracterÃ­sticas especiales

NOTA: Al cambiar la foto de perfil, no se puede volver a ejecutar predicciÃ³n de IA


4.2 PROCESO
-----------

1. Formulario precargado con datos actuales
2. Usuario modifica campos deseados
4. Presiona "Guardar Cambios"
5. Validaciones:
   âœ“ Nombre no vacÃ­o
   âœ“ Foto vÃ¡lida (si se cambiÃ³)
6. ActualizaciÃ³n en base de datos
7. NotificaciÃ³n: "Mascota actualizada correctamente"
8. RedirecciÃ³n a detalle de mascota


================================================================================
5. REGISTRO BIOMÃ‰TRICO DE MASCOTAS
================================================================================

URL: /mascota/<id>/biometria/

PROPÃ“SITO: Permitir que el sistema reconozca a la mascota mediante reconocimiento facial canino

5.1 REQUISITOS
--------------

CANTIDAD DE IMÃGENES:
- MÃNIMO: 5 imÃ¡genes obligatorias para entrenar
- MÃXIMO: 20 imÃ¡genes por mascota
- RECOMENDADO: 10-15 imÃ¡genes para mejor precisiÃ³n

CALIDAD DE IMÃGENES:
âœ“ Rostro del perro visible
âœ“ Diferentes Ã¡ngulos (frente, semi-perfil)
âœ“ Diferentes expresiones
âœ“ Diferentes condiciones de iluminaciÃ³n
âœ“ ResoluciÃ³n mÃ­nima: 50x50 pÃ­xeles
âœ“ Formato: JPG, PNG, WEBP
âœ“ TamaÃ±o mÃ¡ximo: 5 MB por imagen


5.2 MÃ‰TODOS DE CAPTURA
----------------------

EL SISTEMA OFRECE 2 MÃ‰TODOS:

MÃ‰TODO 1: CAPTURA POR CÃMARA WEB
- Ideal para: Captura en tiempo real
- Proceso:
  1. Autorizar acceso a cÃ¡mara
  2. Posicionar perro frente a cÃ¡mara
  3. Vista previa en vivo
  4. Clic en "Capturar" por cada foto
  5. Vista previa de cada captura
  6. OpciÃ³n de descartar si no gusta

MODO AUTOMÃTICO (CÃMARA):
- Configurable: 1-20 capturas
- Intervalo: 2 segundos entre cada captura
- Proceso:
  1. Posicionar perro
  2. Seleccionar cantidad (ej: 10 fotos)
  3. Presionar "Iniciar Captura AutomÃ¡tica"
  4. Contador: 3, 2, 1...
  5. Sistema captura automÃ¡ticamente
  6. Mover/girar perro entre capturas para variedad

MÃ‰TODO 2: SUBIR ARCHIVOS
- Ideal para: Fotos ya existentes en dispositivo
- Proceso:
  1. Clic en "Seleccionar Archivos"
  2. Explorador de archivos se abre
  3. SelecciÃ³n mÃºltiple permitida (Ctrl/Cmd + clic)
  4. MÃ¡ximo 20 archivos a la vez
  5. Vista previa de todas las seleccionadas
  6. OpciÃ³n de remover individualmente antes de subir


5.3 PROCESO COMPLETO DE REGISTRO BIOMÃ‰TRICO
-------------------------------------------

FASE 1: CAPTURA/SELECCIÃ“N DE IMÃGENES

1. Usuario elige mÃ©todo (cÃ¡mara o archivo)
2. Captura/selecciona de 5 a 20 imÃ¡genes
3. Vista previa de todas las imÃ¡genes
4. OpciÃ³n de eliminar alguna si no gusta
5. Contador visible: "5/20 imÃ¡genes"

FASE 2: SUBIDA AL SERVIDOR

1. Usuario presiona "Subir ImÃ¡genes"
2. Loading con barra de progreso
3. Cada imagen se procesa:
   
   A) DETECCIÃ“N DE ROSTRO CANINO:
      - Modelo: Haar Cascade Classifier
      - Busca rostro de perro en imagen
      - Si NO detecta â†’ Imagen rechazada con mensaje
      - Si detecta â†’ ContinÃºa procesamiento

   B) EXTRACCIÃ“N DE CARACTERÃSTICAS:
      - Modelo: EfficientNet B0
      - Procesamiento:
        * Recorte del rostro detectado
        * RedimensiÃ³n a 224x224 pÃ­xeles
        * GeneraciÃ³n de 5 versiones de la imagen:
          - Original completa
          - Crop aleatorio 1 (80% del Ã¡rea)
          - Crop aleatorio 2 (85% del Ã¡rea)
          - Flip horizontal
          - Ajuste de brillo
        * ExtracciÃ³n de embedding por cada versiÃ³n
        * Embedding = vector de 1,280 nÃºmeros
        * Representa caracterÃ­sticas Ãºnicas:
          - Forma de orejas
          - Estructura del hocico
          - TamaÃ±o y forma de ojos
          - Textura del pelaje
          - Patrones de color
          - Marcas distintivas
        * NormalizaciÃ³n del vector

   C) ALMACENAMIENTO:
      - Se guardan 5 embeddings por cada foto
      - Total: Si sube 10 fotos = 50 embeddings
      - Cada embedding vinculado a la mascota

3. Resultado por cada imagen:
   - âœ… "Imagen procesada correctamente"
   - âŒ "No se detectÃ³ rostro canino - rechazada"

FASE 3: ENTRENAMIENTO DEL MODELO

REQUISITO: MÃ­nimo 5 imÃ¡genes procesadas exitosamente

1. Usuario presiona "Entrenar Modelo"
2. Loading: "Entrenando modelo de reconocimiento..."
3. Proceso en servidor:
   
   A) RECOPILACIÃ“N DE DATOS:
      - Se obtienen TODOS los embeddings de TODAS las mascotas
      - Ejemplo:
        * Mascota 1 (Max): 50 embeddings
        * Mascota 2 (Luna): 40 embeddings
        * Mascota 3 (Rex): 45 embeddings
        * Total: 135 embeddings
   
   B) PREPARACIÃ“N DE DATOS:
      - X = Matriz de embeddings (135 x 1,280)
      - y = Vector de IDs de mascotas (135 elementos)
      - Cada embedding etiquetado con ID de su mascota

   C) ENTRENAMIENTO DE CLASIFICADOR KNN:
      - Algoritmo: K-Nearest Neighbors
      - ParÃ¡metros:
        * k = 7 (considera 7 vecinos mÃ¡s cercanos)
        * weights = 'distance' (vecinos mÃ¡s cerca = mÃ¡s voto)
        * metric = 'cosine' (similitud coseno)
      - Entrenamiento:
        * Modelo aprende la distribuciÃ³n de embeddings
        * Crea "mapa" de caracterÃ­sticas por mascota
   
   D) GUARDADO DEL MODELO:
      - Modelo serializado con Pickle
      - Guardado en: models/modelo_global.pkl
      - TamaÃ±o aproximado: 1-5 MB

4. Resultado:
   - âœ… "Modelo entrenado exitosamente"
   - ActualizaciÃ³n de estado: biometria_entrenada = True
   - Mascota ahora reconocible por escÃ¡ner

FASE 4: CONFIRMACIÃ“N

1. NotificaciÃ³n: "BiometrÃ­a registrada correctamente"
2. Estado actualizado en detalle de mascota
3. Badge verde: "BiometrÃ­a Activa"
4. Opciones disponibles:
   - Agregar mÃ¡s imÃ¡genes (hasta 20 total)
   - Re-entrenar modelo
   - Eliminar biometrÃ­a


5.4 CONTADOR DE IMÃGENES
------------------------

Panel de estado visible:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š ESTADO DE BIOMETRÃA              â”‚
â”‚                                      â”‚
â”‚  ImÃ¡genes registradas: 10/20        â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50%          â”‚
â”‚                                      â”‚
â”‚  Estado: âœ… Activa                   â”‚
â”‚  Puede entrenar: SÃ­                 â”‚
â”‚  ImÃ¡genes restantes: 10             â”‚
â”‚                                      â”‚
â”‚  [Agregar mÃ¡s] [Re-entrenar]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


5.5 AGREGAR MÃS IMÃGENES
------------------------

Si la mascota ya tiene biometrÃ­a activa (â‰¥5 imÃ¡genes):

1. OpciÃ³n: "Agregar mÃ¡s imÃ¡genes biomÃ©tricas"
2. LÃ­mite: Hasta completar 20 total
3. Proceso igual que registro inicial
4. DespuÃ©s de agregar:
   - OpciÃ³n: "Re-entrenar modelo"
   - RecomendaciÃ³n: Re-entrenar para mejor precisiÃ³n


5.6 ELIMINAR BIOMETRÃA
----------------------

UbicaciÃ³n: Detalle de mascota â†’ SecciÃ³n de BiometrÃ­a

PROCESO:

1. BotÃ³n: "Eliminar Registro BiomÃ©trico"
2. Modal de confirmaciÃ³n:
   - Advertencia: "Se eliminarÃ¡n TODAS las imÃ¡genes y embeddings"
   - Advertencia: "La mascota NO podrÃ¡ ser reconocida por el escÃ¡ner"
   - Advertencia: "Esta acciÃ³n NO se puede deshacer"
3. Usuario confirma
4. Sistema ejecuta:
   - Elimina todas las imÃ¡genes biomÃ©tricas
   - Elimina todos los embeddings de la BD
   - Marca biometria_entrenada = False
   - Re-entrena modelo global (sin esta mascota)
5. NotificaciÃ³n: "BiometrÃ­a eliminada correctamente"
6. Estado actualizado: "Sin BiometrÃ­a"


5.7 RECOMENDACIONES PARA MEJOR RECONOCIMIENTO
---------------------------------------------

VARIEDAD ES CLAVE:

ÃNGULOS RECOMENDADOS:
âœ“ 3-4 fotos de frente
âœ“ 2-3 fotos de perfil derecho
âœ“ 2-3 fotos de perfil izquierdo
âœ“ 2-3 fotos con diferentes expresiones

CONDICIONES:
âœ“ 3-4 fotos con luz natural
âœ“ 2-3 fotos con luz artificial
âœ“ 1-2 fotos en exterior
âœ“ 1-2 fotos en interior

EXPRESIONES:
âœ“ Con boca cerrada
âœ“ Con lengua afuera
âœ“ Con orejas paradas
âœ“ Con orejas relajadas

EVITAR:
âœ— Todas las fotos iguales
âœ— Todas del mismo Ã¡ngulo
âœ— Solo selfies con dueÃ±o
âœ— Fotos muy oscuras
âœ— Fotos muy borrosas
âœ— MÃºltiples perros en la foto


================================================================================
6. ESCÃNER DE RECONOCIMIENTO DE MASCOTAS
================================================================================

URL: /mascota/scanner/

PROPÃ“SITO: Identificar mascotas mediante reconocimiento facial o cÃ³digo QR

6.1 REQUISITOS PARA RECONOCIMIENTO FACIAL
-----------------------------------------

MASCOTA A IDENTIFICAR:
âœ“ Debe tener biometrÃ­a registrada (â‰¥5 imÃ¡genes)
âœ“ Modelo global debe estar entrenado

USUARIO DEL ESCÃNER:
- Puede ser cualquier usuario autenticado
- No necesita ser el propietario
- Ãštil para: Veterinarios, refugios, personas que encuentran mascota


6.2 MÃ‰TODOS DE ESCANEO
----------------------

EL ESCÃNER OFRECE 2 MODOS:

MODO 1: RECONOCIMIENTO FACIAL
- Captura foto del perro
- Sistema lo identifica automÃ¡ticamente

6.3 PROCESO DE RECONOCIMIENTO FACIAL
------------------------------------

PASO 1: CAPTURA DE IMAGEN

Opciones:
A) TOMAR FOTO CON CÃMARA:
   - BotÃ³n: "Usar CÃ¡mara"
   - Autorizar acceso a cÃ¡mara
   - Apuntar a la mascota
   - Presionar "Capturar"

B) SUBIR FOTO EXISTENTE:
   - BotÃ³n: "Subir Foto"
   - Seleccionar archivo
   - Formatos: JPG, PNG, WEBP
   - MÃ¡ximo: 5 MB

PASO 2: PROCESAMIENTO

1. Loading: "Identificando mascota..."
2. Proceso en servidor:
   
   A) DETECCIÃ“N DE ROSTRO:
      - Haar Cascade busca rostro canino
      - Si NO detecta:
        * Error: "No se detectÃ³ un perro en la imagen"
        * Proceso se cancela
      - Si detecta:
        * Recorta Ã¡rea del rostro
        * ContinÃºa con reconocimiento

   B) EXTRACCIÃ“N DE CARACTERÃSTICAS:
      - EfficientNet B0 procesa la imagen
      - Genera embedding de 1,280 nÃºmeros
      - Normaliza el vector

   C) COMPARACIÃ“N CON BASE DE DATOS:
      - Modelo KNN carga
      - Compara embedding con TODOS los embeddings registrados
      
      Para cada mascota con biometrÃ­a:
      - Calcula similitud coseno con sus embeddings
      - Ejemplo para "Max":
        * Similitud con embedding 1: 0.89
        * Similitud con embedding 2: 0.85
        * Similitud con embedding 3: 0.88
        * Similitud con embedding 4: 0.72
        * ...
        * Similitud con embedding 50: 0.65
      
      - Toma TOP 3 similitudes mÃ¡s altas
      - Calcula promedio: (0.89 + 0.88 + 0.85) / 3 = 0.873
      
      - Calcula factor de consistencia:
        * CuÃ¡ntos embeddings tienen similitud â‰¥ 0.7
        * Ejemplo: 35 de 50 = 70%
      
      - PuntuaciÃ³n final:
        * similitud_promedio Ã— (0.8 + 0.2 Ã— consistencia)
        * 0.873 Ã— (0.8 + 0.2 Ã— 0.70)
        * 0.873 Ã— 0.94
        * = 0.821 (82.1% de confianza)
      
      - Repite para todas las mascotas
      - Ordena por puntuaciÃ³n final
      - Toma la de mayor puntuaciÃ³n

   D) DECISIÃ“N:
      - Umbral de aceptaciÃ³n: 30%
      - Si puntuaciÃ³n â‰¥ 0.30 â†’ IDENTIFICACIÃ“N EXITOSA âœ…
      - Si puntuaciÃ³n < 0.30 â†’ NO IDENTIFICADA âŒ

PASO 3: RESULTADOS

CASO A: IDENTIFICACIÃ“N EXITOSA (â‰¥30%)

Panel de resultados:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… MASCOTA IDENTIFICADA                     â”‚
â”‚                                              â”‚
â”‚  [Foto de perfil grande]                    â”‚
â”‚                                              â”‚
â”‚  ğŸ• MAX                                      â”‚
â”‚  Confianza: 82.1% (Alta)                    â”‚
â”‚                                              â”‚
â”‚  ğŸ“Š INFORMACIÃ“N                              â”‚
â”‚  â€¢ Raza: Golden Retriever                   â”‚
â”‚  â€¢ Edad: 3 aÃ±os                             â”‚
â”‚  â€¢ Sexo: Macho                              â”‚
â”‚  â€¢ CondiciÃ³n: Normal                        â”‚
â”‚  â€¢ CaracterÃ­sticas: Cicatriz oreja derecha  â”‚
â”‚                                              â”‚
â”‚  ğŸ‘¤ PROPIETARIO                              â”‚
â”‚  â€¢ Nombre: Juan PÃ©rez                       â”‚
â”‚  â€¢ Email: juan@email.com                    â”‚
â”‚  â€¢ TelÃ©fono: 0999999999                     â”‚
â”‚                                              â”‚
â”‚  ğŸš¨ ESTADO                                   â”‚
â”‚  NORMAL / âš ï¸ REPORTADA COMO PERDIDA         â”‚
â”‚                                              â”‚
â”‚  Si estÃ¡ perdida:                           â”‚
â”‚  [ğŸ“ Reportar como Encontrada]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CASO B: NO IDENTIFICADA (<30%)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ MASCOTA NO IDENTIFICADA              â”‚
â”‚                                          â”‚
â”‚  No se pudo reconocer a esta mascota    â”‚
â”‚                                          â”‚
â”‚  Posibles razones:                      â”‚
â”‚  â€¢ No tiene biometrÃ­a registrada        â”‚
â”‚  â€¢ Foto de baja calidad                 â”‚
â”‚  â€¢ Ãngulo difÃ­cil                       â”‚
â”‚  â€¢ Cambios fÃ­sicos (corte de pelo)     â”‚
â”‚                                          â”‚
â”‚  Sugerencias:                           â”‚
â”‚  â€¢ Toma otra foto de mejor calidad     â”‚
â”‚  â€¢ Prueba otro Ã¡ngulo                  â”‚
â”‚  â€¢ Escanea su cÃ³digo QR                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

6.5 REPORTAR MASCOTA COMO ENCONTRADA
------------------------------------

DISPONIBLE SOLO SI: Mascota estÃ¡ reportada como perdida

PROCESO:

1. BotÃ³n destacado: "ğŸ“ Reportar como Encontrada"
2. Modal se abre:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Â¿Encontraste a [Nombre]?           â”‚
   â”‚                                     â”‚
   â”‚  Esto notificarÃ¡ al propietario    â”‚
   â”‚  con tu ubicaciÃ³n aproximada       â”‚
   â”‚                                     â”‚
   â”‚  [Permitir ubicaciÃ³n] (opcional)   â”‚
   â”‚                                     â”‚
   â”‚  [Cancelar] [Confirmar]            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Si usuario permite ubicaciÃ³n:
   - Sistema captura coordenadas GPS
   - Latitud y Longitud

4. Al confirmar:
   - Marca mascota como NO perdida
   - EnvÃ­a EMAIL al propietario con:
     * Mensaje: "Â¡Alguien encontrÃ³ a [Nombre]!"
     * Coordenadas GPS (si se autorizÃ³)
     * Timestamp del encuentro
     * InformaciÃ³n del dispositivo (IP, navegador)
   - Crea notificaciÃ³n in-app para propietario:
     * TÃ­tulo: "Â¡Alguien encontrÃ³ a [Nombre]!"
     * Mensaje: "Buenas noticias! Alguien encontrÃ³ a tu mascota cerca de [coordenadas]"
     * Link a mapa (si hay coordenadas)
   - Mensaje al usuario del escÃ¡ner:
     * "Reporte enviado exitosamente"
     * "El propietario ha sido notificado"

5. Propietario recibe:
   - Email inmediato
   - NotificaciÃ³n in-app
   - Puede ver coordenadas en mapa
   - InformaciÃ³n de contacto (si el reportante dejÃ³)


6.6 REGISTRO DE ESCANEOS
------------------------

Cada reconocimiento exitoso se registra en BD:

Tabla: RegistroReconocimiento
- mascota_id
- fecha_reconocimiento
- confianza
- metodo (facial o qr)
- usuario_escaner_id (opcional)
- ubicacion (coordenadas si se autorizÃ³)

USO:
- EstadÃ­sticas de cuÃ¡ntas veces fue reconocida
- Historial de escaneos
- Seguimiento si estÃ¡ perdida


================================================================================
7. GENERACIÃ“N DE CÃ“DIGO QR
================================================================================

URL: /mascota/<id>/qr/generar/

7.1 PROPÃ“SITO
-------------

Generar cÃ³digo QR que contiene:
- Enlace pÃºblico a informaciÃ³n de la mascota
- NO requiere login para ver
- Ãštil para: Placas de identificaciÃ³n, carnets, compartir

7.2 PROCESO
-----------

1. Usuario accede desde detalle de mascota
2. Presiona "Generar CÃ³digo QR"
3. Sistema genera:
   - UUID Ãºnico de la mascota (si no existe)
   - URL pÃºblica: https://sistema.com/mascota/public/<uuid>/
   - CÃ³digo QR de alta calidad:
     * VersiÃ³n 1 (pantalla): 256x256 px
     * VersiÃ³n 2 (descarga): 512x512 px
     * Formato: PNG con fondo blanco
     * CorrecciÃ³n de errores: Nivel M (15%)

7.3 OPCIONES DISPONIBLES
------------------------

VISTA PREVIA:
- QR se muestra en pantalla
- CÃ³digo en formato base64
- Vista previa del enlace

DESCARGAR:
- BotÃ³n: "Descargar QR"
- Archivo: qr_[nombre_mascota].png
- TamaÃ±o: 512x512 px (alta calidad)
- Listo para imprimir

COMPARTIR:
- Copiar enlace pÃºblico
- Compartir por WhatsApp
- Compartir por email
- Compartir en redes sociales

IMPRIMIR:
- Vista de impresiÃ³n optimizada
- QR centrado
- Nombre de mascota incluido


7.4 INFORMACIÃ“N PÃšBLICA (VÃA QR)
--------------------------------

URL: /mascota/public/<uuid>/
Acceso: Sin login requerido

INFORMACIÃ“N VISIBLE:
âœ“ Nombre de la mascota
âœ“ Foto de perfil
âœ“ Raza
âœ“ Edad
âœ“ Sexo
âœ“ Color
âœ“ CaracterÃ­sticas especiales
âœ“ InformaciÃ³n de contacto del propietario:
  - Nombre completo
  - Email
  - TelÃ©fono
âœ“ Estado (perdida o normal)

INFORMACIÃ“N NO VISIBLE:
âœ— Peso
âœ— CondiciÃ³n corporal
âœ— Fecha de nacimiento exacta
âœ— Historial veterinario

SI MASCOTA ESTÃ PERDIDA:
- Alerta destacada en rojo
- BotÃ³n: "Reportar como Encontrada"
- Proceso igual que en escÃ¡ner


================================================================================
8. GENERACIÃ“N DE CARNETS
================================================================================

URL: /mascota/carnets/

8.1 PROPÃ“SITO
-------------

Generar carnet digital/fÃ­sico de identificaciÃ³n de la mascota
Similar a una cÃ©dula de identidad

8.2 LISTA DE CARNETS
--------------------

Vista: Tarjetas de todas las mascotas del usuario

Cada tarjeta muestra:
- Vista previa del carnet
- Nombre de la mascota
- Estado: Generado / No generado
- Acciones:
  * Ver carnet completo
  * Descargar PDF
  * Imprimir

8.3 CONTENIDO DEL CARNET
------------------------

DISEÃ‘O:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¥ CARNET DE IDENTIFICACIÃ“N CANINA     â”‚
â”‚  Sistema de GestiÃ³n Veterinaria        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  [Foto de perfil]    [CÃ³digo QR]       â”‚
â”‚     circular            grande         â”‚
â”‚                                         â”‚
â”‚  ğŸ• NOMBRE: [Nombre]                    â”‚
â”‚  ğŸ“Š RAZA: [Raza]                        â”‚
â”‚  ğŸ‚ EDAD: [X aÃ±os]                      â”‚
â”‚  âš¥ SEXO: [Macho/Hembra]                â”‚
â”‚  ğŸ¨ COLOR: [Color]                      â”‚
â”‚                                         â”‚
â”‚  âš ï¸ CARACTERÃSTICAS ESPECIALES:         â”‚
â”‚  [Texto de caracterÃ­sticas]            â”‚
â”‚                                         â”‚
â”‚  ğŸ‘¤ PROPIETARIO:                        â”‚
â”‚  [Nombre completo]                     â”‚
â”‚  ğŸ“§ [Email]                             â”‚
â”‚  ğŸ“± [TelÃ©fono]                          â”‚
â”‚                                         â”‚
â”‚  ğŸ“… Fecha de emisiÃ³n: [Fecha actual]   â”‚
â”‚  ğŸ†” ID: [UUID corto]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  "Este carnet identifica oficialmente â”‚
â”‚   a la mascota registrada en el       â”‚
â”‚   Sistema de GestiÃ³n Veterinaria"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

8.4 OPCIONES
------------

VER CARNET:
- Vista completa en pantalla
- DiseÃ±o responsivo
- Todos los datos visibles

DESCARGAR PDF:
- Formato: PDF de alta calidad
- TamaÃ±o: A4 o carta
- Listo para imprimir
- Nombre archivo: carnet_[nombre_mascota].pdf

IMPRIMIR:
- Abre diÃ¡logo de impresiÃ³n
- CSS optimizado para impresiÃ³n
- Sin mÃ¡rgenes innecesarios
- Colores ajustados para tinta


8.5 USO DEL CARNET
-----------------

UTILIDAD:
âœ“ IdentificaciÃ³n fÃ­sica de la mascota
âœ“ Llevar en collar o arnÃ©s
âœ“ Presentar en veterinarias
âœ“ TrÃ¡mites de viaje
âœ“ Registros municipales
âœ“ IdentificaciÃ³n en caso de pÃ©rdida

================================================================================
9. SISTEMA DE MASCOTAS PERDIDAS
================================================================================

9.1 REPORTAR MASCOTA COMO PERDIDA
---------------------------------

ACCESO:
- Detalle de mascota â†’ BotÃ³n "Reportar como Perdida"

PROCESO:

1. Modal de confirmaciÃ³n se abre:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  âš ï¸ REPORTAR MASCOTA COMO PERDIDA     â”‚
   â”‚                                        â”‚
   â”‚  Esto enviarÃ¡ una ALERTA MASIVA a    â”‚
   â”‚  TODOS los usuarios del sistema       â”‚
   â”‚                                        â”‚
   â”‚  ğŸ“ UbicaciÃ³n (opcional):             â”‚
   â”‚  [______________________________]     â”‚
   â”‚  Ej: "Cerca del parque central"      â”‚
   â”‚                                        â”‚
   â”‚  [Cancelar] [Confirmar Reporte]      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. Usuario puede agregar ubicaciÃ³n (texto libre)

3. Al confirmar:
   
   A) ACTUALIZACIÃ“N DE ESTADO:
      - mascota.reportar_perdida = True
      - Fecha de reporte se guarda
   
   B) EMAIL MASIVO:
      - Destinatarios: TODOS los usuarios con email
      - ExcepciÃ³n: No al propietario (ya sabe)
      - Asunto: "ğŸš¨ Alerta: [Nombre] ha sido reportada como perdida"
      - Contenido HTML:
        * Foto grande de la mascota
        * Nombre y descripciÃ³n completa
        * UbicaciÃ³n donde se perdiÃ³
        * CaracterÃ­sticas especiales
        * Datos de contacto del propietario:
          - Nombre completo
          - Email
          - TelÃ©fono
        * Link al cÃ³digo QR pÃºblico
        * BotÃ³n: "Ver informaciÃ³n completa"
   
   C) NOTIFICACIÃ“N IN-APP:
      - Para todos los usuarios
      - TÃ­tulo: "Mascota perdida: [Nombre]"
      - Mensaje: "[Propietario] reportÃ³ que [Nombre] se perdiÃ³ cerca de [ubicaciÃ³n]"
      - Link a informaciÃ³n pÃºblica
   
   D) DASHBOARD:
      - Aparece en secciÃ³n "Mascotas Perdidas"
      - Badge rojo parpadeante
      - Contador de mascotas perdidas aumenta

4. ConfirmaciÃ³n al propietario:
   - NotificaciÃ³n: "[Nombre] ha sido reportada como perdida. Se ha enviado una alerta a todos los usuarios."
   - Email de confirmaciÃ³n al propietario

9.2 VISUALIZACIÃ“N DE MASCOTAS PERDIDAS
--------------------------------------

UBICACIONES:

1. DASHBOARD GENERAL (todos los usuarios):
   - SecciÃ³n destacada: "Mascotas Reportadas como Perdidas"
   - Carousel de tarjetas
   - Cada tarjeta muestra:
     * Foto de la mascota
     * Nombre
     * Raza y edad
     * UbicaciÃ³n donde se perdiÃ³
     * DÃ­as desde que se reportÃ³
     * BotÃ³n: "Ayudar a encontrarla"

2. DASHBOARD ADMIN:
   - EstadÃ­stica: Total de mascotas perdidas
   - Lista completa con filtros
   - Datos de seguimiento

3. LISTA DE MASCOTAS (propietario):
   - Su mascota perdida con badge rojo
   - AnimaciÃ³n de pulso
   - BotÃ³n destacado: "Marcar como encontrada"


9.3 CUANDO ALGUIEN ENCUENTRA LA MASCOTA
---------------------------------------

ESCENARIO A: VÃA ESCÃNER

1. Alguien usa el escÃ¡ner (facial)
2. Mascota es identificada
3. Sistema detecta: mascota.reportar_perdida = True
4. Alerta destacada en pantalla:
   "âš ï¸ ESTA MASCOTA ESTÃ REPORTADA COMO PERDIDA"
5. BotÃ³n grande: "Reportar como Encontrada"
6. Proceso descrito en secciÃ³n 6.5

9.4 NOTIFICACIÃ“N AL PROPIETARIO
-------------------------------

CUANDO ALGUIEN REPORTA ENCONTRARLA:

EMAIL:
- Asunto: "âœ… Â¡Alguien encontrÃ³ a [Nombre]!"
- Contenido:
  * Mensaje de buenas noticias
  * Foto de la mascota
  * Timestamp exacto del encuentro
  * Coordenadas GPS (si se autorizÃ³):
    - Latitud y Longitud
  * InformaciÃ³n del reporte:
    - DirecciÃ³n IP (para referencia)
    - Navegador utilizado
  * Instrucciones:
    - "Contacta con las autoridades locales"
    - "Verifica la zona indicada"
    - "Lleva identificaciÃ³n de propiedad"

NOTIFICACIÃ“N IN-APP:
- Alerta destacada (notificaciÃ³n SUCCESS)
- TÃ­tulo: "Â¡Alguien encontrÃ³ a [Nombre]!"
- Mensaje: "Alguien reportÃ³ haber encontrado a [Nombre] cerca de [coordenadas]. Revisa tu email para mÃ¡s detalles."
- Icono: âœ… verde parpadeante


9.5 MARCAR COMO ENCONTRADA (PROPIETARIO)
----------------------------------------

PROCESO:

1. Propietario recupera a su mascota
2. Va a detalle de mascota
3. BotÃ³n: "Marcar como Encontrada"
4. Modal de confirmaciÃ³n
5. Al confirmar:
   - mascota.reportar_perdida = False
   - NotificaciÃ³n: "[Nombre] ha sido marcada como encontrada"
   - Se remueve de dashboards de mascotas perdidas
   - Email de cierre a usuarios que ayudaron (opcional)
   - Badge cambia de rojo a verde


9.6 ESTADÃSTICAS (ADMIN)
------------------------

Dashboard administrativo muestra:
- Total de mascotas perdidas actualmente
- Historial de mascotas perdidas (resueltas)
- Tiempo promedio de localizaciÃ³n
- Tasa de Ã©xito de recuperaciÃ³n
- Usuarios mÃ¡s activos en reportes


================================================================================
10. DASHBOARD DE USUARIO (OWNER/VET)
================================================================================

URL: /dashboard/

10.1 SECCIONES PRINCIPALES
--------------------------

SECCIÃ“N 1: ESTADÃSTICAS PERSONALES

Para OWNER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š MIS ESTADÃSTICAS                    â”‚
â”‚                                         â”‚
â”‚  ğŸ• Mascotas: 2/2                       â”‚
â”‚  âœ… Con BiometrÃ­a: 1                    â”‚
â”‚  ğŸš¨ Perdidas: 0                         â”‚
â”‚  ğŸ“‹ Escaneos totales: 15                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Para VET:
- EstadÃ­sticas de todas las mascotas
- Pacientes atendidos
- Ãšltimas consultas


SECCIÃ“N 2: MIS MASCOTAS

Vista rÃ¡pida de las 2 mascotas:
- Foto miniatura
- Nombre
- Estado (normal/perdida)
- BiometrÃ­a (activa/inactiva)
- Botones de acciÃ³n rÃ¡pida:
  * Ver detalle
  * Editar
  * QR
  * Carnet


SECCIÃ“N 3: ACCESOS RÃPIDOS

Botones grandes:
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ•   â”‚ â”‚ ğŸ“·   â”‚ â”‚ ğŸ†”   â”‚ â”‚ ğŸ‘¤   â”‚
â”‚Regis-â”‚ â”‚Scannerâ”‚ â”‚Carnetsâ”‚ â”‚Perfilâ”‚
â”‚trar  â”‚ â”‚       â”‚ â”‚       â”‚ â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜


SECCIÃ“N 4: MASCOTAS PERDIDAS (comunidad)

- Tarjetas de mascotas perdidas de otros usuarios
- OpciÃ³n de ayudar a encontrarlas
- InformaciÃ³n de contacto


SECCIÃ“N 5: NOTIFICACIONES RECIENTES

- Ãšltimas 5 notificaciones
- Link a "Ver todas"


SECCIÃ“N 6: GRÃFICO DE ACTIVIDAD (si tiene datos)

- GrÃ¡fico circular: Mascotas Activas vs Perdidas
- Solo para el usuario


================================================================================
11. CONSIDERACIONES TÃ‰CNICAS IMPORTANTES
================================================================================

11.1 MODELOS DE INTELIGENCIA ARTIFICIAL
---------------------------------------

PREDICCIÃ“N DE MASCOTAS (Registro):
- Modelo Multi-Tarea: ResNet-18 (11.7M parÃ¡metros)
- Modelo CondiciÃ³n: ResNet-50 (25.6M parÃ¡metros)
- Archivo: final_multitask_dog_model.pth (45 MB)
- Archivo: dog_body_condition_classifier.pth (98 MB)
- PrecisiÃ³n esperada: 95-99% (razas entrenadas)

RECONOCIMIENTO FACIAL USUARIO:
- Modelo: ArcFace ResNet100
- Archivo: arcfaceresnet100-8.onnx
- PrecisiÃ³n: 99.77% (benchmark LFW)
- Descriptor: 512 dimensiones

RECONOCIMIENTO FACIAL MASCOTA:
- Modelo: EfficientNet B0 (5.3M parÃ¡metros)
- Descriptor: 1,280 dimensiones
- Clasificador: K-Nearest Neighbors (k=7)
- PrecisiÃ³n esperada: 85-92% (con 10-20 fotos)


11.2 LÃMITES Y RESTRICCIONES DEL SISTEMA
----------------------------------------

MASCOTAS POR USUARIO:
- OWNER: 2 mascotas mÃ¡ximo (estricto)
- VET: 2 mascotas mÃ¡ximo (estricto)
- ADMIN: Sin lÃ­mite

IMÃGENES BIOMÃ‰TRICAS (MASCOTA):
- MÃ­nimo: 5 imÃ¡genes
- MÃ¡ximo: 20 imÃ¡genes
- TamaÃ±o archivo: 5 MB por imagen

IMÃGENES BIOMÃ‰TRICAS (USUARIO):
- 1 registro facial por usuario
- Reemplazable

PREDICCIÃ“N DE RAZAS:
- Solo detecta: Bulldog, Chihuahua, Golden Retriever
- Otras razas: Se marca como "Otra raza"
- Usuario puede editar manualmente

FORMATOS DE ARCHIVO:
- ImÃ¡genes: JPG, JPEG, PNG, WEBP
- Carnets: PDF
- QR: PNG


11.3 REQUERIMIENTOS DEL CLIENTE
-------------------------------

NAVEGADOR:
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

PERMISOS:
- CÃ¡mara web (para captura de fotos)
- GeolocalizaciÃ³n (opcional, para reportar encontrada)

CONEXIÃ“N:
- Internet estable para IA y predicciones
- MÃ­nimo 2 Mbps para video en tiempo real


================================================================================
FIN DE PARTE 2 - MASCOTAS Y FUNCIONALIDADES
================================================================================

RESUMEN COMPLETO DEL SISTEMA:

âœ… AUTENTICACIÃ“N:
   - Login tradicional (email + password)
   - Login con reconocimiento facial (ArcFace)
   - Registro de usuarios
   - RecuperaciÃ³n de contraseÃ±a
   - 3 roles: ADMIN, VET, OWNER

âœ… GESTIÃ“N DE MASCOTAS:
   - Registro con predicciÃ³n de IA automÃ¡tica
   - LÃ­mite de 2 mascotas por OWNER
   - EdiciÃ³n y eliminaciÃ³n
   - Lista personalizada por rol

âœ… BIOMETRÃA CANINA:
   - 5-20 imÃ¡genes por mascota
   - EfficientNet B0 + KNN
   - Reconocimiento con 85-92% precisiÃ³n

âœ… ESCÃNER:
   - Reconocimiento facial canino
   - Reportar mascotas encontradas

âœ… MASCOTAS PERDIDAS:
   - Reporte con email masivo
   - Notificaciones a todos los usuarios
   - GeolocalizaciÃ³n al encontrarlas

âœ… CÃ“DIGO QR:
   - GeneraciÃ³n automÃ¡tica
   - Enlace pÃºblico sin login

âœ… CARNETS:
   - DiseÃ±o profesional
   - Descarga PDF
   - ImpresiÃ³n optimizada

âœ… NOTIFICACIONES:
   - Sistema interno (in-app)
   - Persistentes en BD
   - 6 categorÃ­as, 4 tipos
   - Emails solo para casos crÃ­ticos

âœ… DASHBOARDS:
   - Usuario: EstadÃ­sticas personales
   - Admin: 9 grÃ¡ficos, 8 mÃ©tricas globales

ESTA DOCUMENTACIÃ“N ESTÃ LISTA PARA GENERAR EL MANUAL DE USUARIO EN VITE + REACT
